<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Rechnungsprogramm – iPhone PDF FIX</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- html2pdf -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body {
    font-family: Arial; margin: 0; background: #eef0f4;
}
header {
    background:#1f2937; color:white; padding:20px; text-align:center;
}
.container { max-width:900px; margin:auto; padding:20px; }
.box {
    background:white; padding:20px; border-radius:12px;
    box-shadow:0 0 15px rgba(0,0,0,0.1); margin-bottom:20px;
}
input {
    width:100%; padding:10px; margin-bottom:12px; border-radius:6px;
    border:1px solid #ccc; text-align:center;
}
button {
    padding:10px 14px; border:none; border-radius:6px; cursor:pointer;
    margin:4px; font-size:15px;
}
.save { background:#16a34a; color:white; }
.clear { background:#dc2626; color:white; }
.edit { background:#ea580c; color:white; }
.delete { background:#8b0000; color:white; }
.pdfBtn { background:#2563eb; color:white; }

table {
    width:100%; border-collapse:collapse; margin-top:10px;
}
th,td {
    padding:10px; border-bottom:1px solid #ddd; text-align:center;
}
th { background:#f3f4f6; }

.archiv-entry {
    padding:10px 0; border-bottom:1px solid #e5e7eb; font-size:14px;
}

@media print { .no-print { display:none; } }
</style>
</head>
<body>

<header>Rechnungsprogramm – PDF FIX</header>

<div class="container">

<!-- Firmendaten -->
<div class="box no-print">
    <h2>Firmendaten</h2>
    <img src="Logo.png" style="width:120px; margin-bottom:10px;">
    <input id="firma" placeholder="Firma">
    <input id="adresse" placeholder="Adresse">
    <input id="email" placeholder="E-Mail">
    <input id="telefon" placeholder="Telefon">
    <button class="save" id="btnFirmendaten">Speichern</button>
</div>

<!-- Rechnung erstellen -->
<div class="box">
    <h2 class="no-print">Rechnung erstellen</h2>

    <div class="no-print">
        <input id="rnr" placeholder="Rechnungsnummer">
        <input id="kunde" placeholder="Kunde">
        <input id="datum" type="date">

        <h3>Positionen:</h3>
        <table>
            <thead>
                <tr><th>Beschreibung</th><th>Preis (€)</th><th>Aktion</th></tr>
            </thead>
            <tbody id="posBody"></tbody>
        </table>

        <button id="addPosBtn">+ Position</button>

        <h3>Gesamtsumme:</h3>
        <input id="summe" readonly style="font-weight:bold; background:#e5e7eb">

        <button class="save" id="btnSave">Rechnung speichern</button>
        <button class="clear" id="btnClear">Leeren</button>
    </div>

    <!-- PDF-BEREICH – WIRD NICHT ANGEZEIGT -->
    <div id="pdfArea" style="display:none; padding:20px; background:white;">
        <div style="display:flex; gap:20px; align-items:flex-start;">
            <img src="Logo.png" style="width:90px;">
            <div>
                <b><span id="p_firma"></span></b><br>
                <span id="p_adresse"></span><br>
                <span id="p_email"></span><br>
                <span id="p_telefon"></span>
            </div>
        </div>

        <h1 style="text-align:center; margin-top:20px;">Rechnung</h1>

        <p><b>Rechnungsnummer:</b> <span id="p_rnr"></span></p>
        <p><b>Kunde:</b> <span id="p_kunde"></span></p>
        <p><b>Datum:</b> <span id="p_datum"></span></p>

        <table style="margin-top:20px;">
            <thead>
            <tr><th>Beschreibung</th><th>Preis (€)</th></tr>
            </thead>
            <tbody id="p_pos"></tbody>
        </table>

        <h2 style="text-align:right;">Gesamt: <span id="p_summe"></span> €</h2>

        <p style="font-weight:bold;">
            Gemäß §19 UStG wird keine Umsatzsteuer berechnet.
        </p>

        <div style="margin-top:30px;">
            <b>Betrag erhalten – bestätigt durch Unterschrift:</b><br><br>
            <div style="border-bottom:2px solid black; width:250px; height:40px;"></div>
        </div>
    </div>

</div>

<!-- ARCHIV -->
<div class="box no-print">
    <h2>Archiv</h2>
    <div id="archivList"></div>
</div>

</div>

<script>
// Shortcuts
const $ = id => document.getElementById(id);

// Initial Datum
$("datum").value = new Date().
